<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Member implicits</title>
    <link href="./images/s2.ico"                                   type="image/x-icon" rel="specs2 icon"/>
    <link href="./css/opensans-fonts.css"                          type="text/css"     rel="stylesheet" />
    <link href="./css/bootstrap.min.css"                           type="text/css"     rel="stylesheet" />
    <link href="./css/font-awesome.min.css"                        type="text/css"     rel="stylesheet" />
    <link href="./css/prettify.css"                                type="text/css"     rel="stylesheet" />
    <link href="./css/tabber.css"                                  type="text/css"     rel="stylesheet" />
    <link href="./css/tipuesearch.css"                             type="text/css"     rel="stylesheet" />
    <link href="./css/specs2.css"                                  type="text/css"     rel="stylesheet" />
    <link href="./css/specs2-user.css"                             type="text/css"     rel="stylesheet" />

    <script src="./javascript/jquery.js"                           type="text/javascript"></script>
    <script src="./javascript/jquery.jstree.js"                    type="text/javascript"></script>
    <script src="./javascript/tabber.js"                           type="text/javascript"></script>
    <script src="./javascript/tabber_start.js"                     type="text/javascript"></script>
    <script src="./javascript/prettify.js"                         type="text/javascript"></script>
    <script src="./javascript/specs2.js"                           type="text/javascript"></script>
    <script src="./javascript/specs2-user.js"                      type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch_set.js"      type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch_contents.js" type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch.min.js"      type="text/javascript"></script>

</head>
<body onload="prettyPrint()">

<div class="container">

<div class="col-md-1"></div>

<div class="col-md-1"></div>




<div class="col-md-10">
<h1>Member implicits</h1>
<div id="tipue_search_content"></div>

<p>Type inference with the Eff monad can be a bit tricky to get right if we want to avoid type annotations. Here are some tips to help you.</p>
<h3 id="running-effects-with-several-type-parameters">Running effects with several type parameters</h3>
<p>Some effects use 2 type variables, like <code class="prettyprint">Reader</code> or <code class="prettyprint">Writer</code>. If you want to use those effects in an effect stack you need to add a compiler plugin to your build:</p>
<pre><code class="prettyprint">addCompilerPlugin(&quot;com.milessabin&quot; % &quot;si2712fix-plugin_2.11.8&quot; % &quot;1.2.0&quot;)</code></pre>
<h3 id="use-context-bounds-and-type-aliases">Use context bounds and type aliases</h3>
<p>When creating effects you can always “require” a stack containing the right effects with the <code class="prettyprint">MemberIn</code> typeclass:</p>
<pre><code class="prettyprint">import org.atnos.eff._
import org.atnos.eff.all._

type StateInt[A] = State[Int, A]
type WriterString[A] = Writer[String, A]

// for creating state effects
def putAndTell[R](i: Int)(implicit s: StateInt |= R, w: WriterString |= R): Eff[R, Int] =
  for {
    // no type annotations needed!
    _ &lt;- put(i)
    _ &lt;- tell(&quot;stored &quot; + i)
  } yield i</code></pre>
<p>You can even use context bounds to make the declaration of <code class="prettyprint">putAndTell</code> more concise:</p>
<pre><code class="prettyprint">import org.atnos.eff.all._

type _stateInt[R] = State[Int, ?] |= R
type _writerString[R] = Writer[String, ?] |= R

def putAndTell[R :_stateInt :_writerString](i: Int): Eff[R, Int] =
  for {
    _ &lt;- put(i)
    _ &lt;- tell(&quot;stored &quot; + i)
  } yield i</code></pre>
<h3 id="know-your-member-typeclasses">Know your <code class="prettyprint">Member</code> typeclasses</h3>
<p>There are 3 different ways to declare that an effect is part of an effect stack with 3 typeclasses:</p>
<table>
<colgroup>
<col width="16%" />
<col width="8%" />
<col width="29%" />
<col width="45%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Typeclass</th>
<th align="left">Alias</th>
<th align="left">Meaning</th>
<th align="left">When to use it</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code class="prettyprint">MemberIn[M, R]</code></td>
<td align="left"><code class="prettyprint">M |= R</code></td>
<td align="left">“<code class="prettyprint">M</code> is part of <code class="prettyprint">R</code>”</td>
<td align="left">to create <code class="prettyprint">M</code> effects in <code class="prettyprint">R</code></td>
</tr>
<tr class="even">
<td align="left"><code class="prettyprint">MemberInOut[M, R]</code></td>
<td align="left"><code class="prettyprint">M /= R</code></td>
<td align="left">“<code class="prettyprint">M</code> is part of <code class="prettyprint">R</code> and can be extracted from it”</td>
<td align="left">to intercept the effect <code class="prettyprint">M</code> (see <code class="prettyprint">Interpreter.scala</code>) and transform it while staying in the same stack. For example to <code class="prettyprint">handleError</code> for an Error effect</td>
</tr>
<tr class="odd">
<td align="left"><code class="prettyprint">Member[M, R]</code></td>
<td align="left"><code class="prettyprint">M &lt;= R</code></td>
<td align="left">“<code class="prettyprint">M</code> is part of <code class="prettyprint">R</code>, can be extracted from it, and the resulting stack is <code class="prettyprint">m.Out</code>”</td>
<td align="left">to interpret the effect in terms of special values or other effects and remove the effect from the stack</td>
</tr>
</tbody>
</table>
</div>

</div>

</body>
</html>